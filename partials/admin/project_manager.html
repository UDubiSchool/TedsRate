<div id="page-wrapper" class="configurator">
    <div id="alert-wrapper">
        <uib-alert ng-repeat="alert in alerts" type="{{alert.type}}" close="closeAlert($index)">{{alert.msg}}</uib-alert>
    </div>
   <div ng-repeat="(projectKey, project) in projects" class="row clearfix project">

       <div class="section-header clearfix clickable" ng-click="project.collapsed = !project.collapsed">
           <h3 class="pull-left">
               <span><i class="fa fa-angle-right rotate" ng-class="{quarter: !project.collapsed}"></i></span>
               {{project.projectName}}
           </h3>
           <h5 class="pull-left">Assessments: {{project.assessments.length}}</h5>
           <h5 class="pull-left">Completion Rate: {{project.assessments.length ? (project.completedAssessments.length /project.assessments.length * 100 |number:1) + '%'  : 'No Assessments'}}</h5>
       </div>
      <div class="collapsable clearfix" uib-collapse="project.collapsed">

        <teds-dropdown title="Artifacts" header-stats="{count: project.artifacts.length}" class="artifacts container col-xs-12">

          <div class="menu col-xs-12 clearfix">
              <span class="btn btn-primary" ng-click="modals.open('artifact', project, $index)"><i class="fa fa-plus"></i> Add a Artifact</span>
          </div>

          <teds-filter-list list="project.artifactsList" passback="project.selected.artifact">
            <!-- {{project.selected.artifact}} -->
            <h4><a ng-href="project.selected.artifact.artifactURL">{{project.selected.artifact.artifactName}}</a></h4>
            <h5>{{project.selected.artifact.artifactTypeName}}</h5>
            <h5>{{project.selected.artifact.artifactDescription}}</h5>
            <teds-pivot-table class="clearfix" teds-data="project.selected.artifact.stats" teds-options="pivotOptions" teds-passback="project.selected.artifact.passback">
              <div ng-show="project.selected.artifact.passback.row">
                <h5>{{project.selected.artifact.passback.row.name}}</h5>
                <h6>Comments</h6>
                <div ng-repeat="comment in project.selected.artifact.passback.row.comments">
                  <p>{{comment.comment}}</p>
                </div>
                <h6>Screenshots</h6>
                <div ng-repeat="screenshot in project.selected.artifact.passback.row.screenshots">
                  <a>
                      <img ng-src="{{screenshot.screenshotPath}}" class="col-xs-12 img-thumbnail" alt="">
                  </a>
                </div>
              </div>
              <div ng-show="project.selected.artifact.passback.column">
                <h3>Questions</h3>
                <div class="col-sm-6" ng-repeat="question in project.selected.artifact.passback.column.questions">
                  <h4>{{question.name}}</h4>
                  <h5>{{question.desc}}</h5>
                  <nvd3 options="sampleChartOptions" data="question.chartData"></nvd3>
                </div>
              </div>
            </teds-pivot-table>
          </teds-filter-list>

        </teds-dropdown>


        <teds-dropdown title="Scenarios" header-stats="{count: project.scenarios.length}" class="scenarios container col-xs-12 clearfix">

          <div class="menu col-xs-12 clearfix">
              <span class="btn btn-primary" ng-click="modals.open('scenario', project, $index)"><i class="fa fa-plus"></i> Add a Scenario</span>
          </div>
          <teds-filter-list list="project.scenariosList" passback="project.selected.scenario">
            <h4>{{project.selected.scenario.scenarioName}}</h4>
            <h5>{{project.selected.scenario.scenarioDescription}}</h5>
            <teds-pivot-table class="clearfix" teds-data="project.selected.scenario.stats" teds-options="pivotOptions" teds-passback="project.selected.scenario.passback"></teds-pivot-table>
          </teds-filter-list>
        </teds-dropdown>

        <teds-dropdown title="Personas" header-stats="{count: project.personas.length}" class="personas container col-xs-12 clearfix">
          <div ng-repeat="(personaKey, persona) in project.personas" class="clearfix col-xs-6 persona project-item">
              <h5 class="name">{{persona.personaName}}</h5>
              <h6 class="desc">{{persona.personaDesc}}</h6>
          </div>
          <div class="menu col-xs-12 clearfix">
              <span class="btn btn-primary" ng-click="modals.open('persona', project, $index)"><i class="fa fa-plus"></i> Add a Persona</span>
          </div>
        </teds-dropdown>

        <teds-dropdown title="Roles" header-stats="{count: project.roles.length}" class="roles container col-xs-12 clearfix">
          <div ng-repeat="(roleKey, role) in project.roles" class="clearfix col-xs-6 role project-item">
              <h5 class="name">{{role.roleName}}</h5>
              <h6 class="desc">{{role.roleDesc}}</h6>
          </div>
          <div class="menu col-xs-12 clearfix">
              <span class="btn btn-primary" ng-click="modals.open('role', project, $index)"><i class="fa fa-plus"></i> Add a Role</span>
          </div>
        </teds-dropdown>

        <teds-dropdown title="Assessments" header-stats="project.assessmentsStats" class="assessments container col-xs-12 clearfix">
          <div class="menu col-xs-12 clearfix">
              <span class="btn btn-primary" ng-click="modals.open('assessment', project, $index)"><i class="fa fa-plus"></i> Add an Assessment</span>
          </div>
          <teds-filter-list list="project.assessmentsList" passback="project.selected.assignment"></teds-filter-list>
        </teds-dropdown>

        <teds-dropdown title="Configurations" header-stats="project.configurationsStats" class="configurations container col-xs-12 clearfix">
           <div class="menu col-xs-12 clearfix">
               <span class="btn btn-primary" ng-click="modals.open('configuration', project, $index)"><i class="fa fa-plus"></i> Add a Configuration</span>
           </div>
           <teds-filter-list list="project.configurationsList" passback="project.selected.configuration">
              <h4>
                Configuration - {{project.selected.configuration.artifactName}}, {{project.selected.configuration.scenarioName}}
              </h4>
              <div class="col-xs-6">
                <h5>Assessment Configuration</h5>
                <dl>
                  <dt>Artifact</dt>
                  <dd>
                    <h6>{{project.selected.configuration.artifactName}} - {{project.selected.configuration.artifactTypeName}}</h6>
                    <h6>{{project.selected.configuration.artifactDescription}}</h6>
                  </dd>
                  <dt>Scenario</dt>
                  <dd>
                    <h6>{{project.selected.configuration.scenarioName}}</h6>
                    <h6>{{project.selected.configuration.scenarioDescription}}</h6>
                  </dd>
                  <dt>Persona</dt>
                  <dd>
                    <h6>{{project.selected.configuration.personaName}}</h6>
                    <h6>{{project.selected.configuration.personaDescription}}</h6>
                  </dd>
                  <dt>Role</dt>
                  <dd>
                    <h6>{{project.selected.configuration.roleName}}</h6>
                    <h6>{{project.selected.configuration.roleDesc}}</h6>
                  </dd>
                </dl>
              </div>
              <div class="col-xs-6">
                <h5>Attribute Configuration</h5>
                <h6><b>{{project.selected.configuration.attributeConfigurationName}}</b></h6>
                <h6>{{project.selected.configuration.attributeConfigurationDesc}}</h6>
              </div>
              <div class="col-xs-6">
                <h5>Question Configuration</h5>
                <h6><b>{{project.selected.configuration.questionConfigurationName}}</b></h6>
                <h6>{{project.selected.configuration.questionConfigurationDesc}}</h6>
              </div>
              <div class="col-xs-6">
                <h5>UI Configuration</h5>
                <h6><b>{{project.selected.configuration.uiConfigurationName}}</b></h6>
                <h6>{{project.selected.configuration.uiConfigurationDesc}}</h6>
              </div>
           </teds-filter-list>
        </teds-dropdown>
      </div>


   </div>
</div>