<div id="page-wrapper" class="configurator"print-section >
    <div id="alert-wrapper">
        <uib-alert ng-repeat="alert in alerts" type="{{alert.type}}" close="closeAlert($index)">{{alert.msg}}</uib-alert>
    </div>
   <div ng-repeat="(projectKey, project) in projects" class="row clearfix project">

       <div class="section-header clearfix clickable" ng-click="loadProject(project, projectKey)">
           <h3 class="pull-left">
               <span ng-show="!project.loading"><i class="fa fa-angle-right rotate" ng-class="{quarter: !project.collapsed}"></i></span>
               <span ng-show="project.loading"><i class="fa fa-circle-o-notch spin"></i></span>
               {{project.projectName}}
           </h3>
           <h5 class="pull-left">Assessments: {{project.counts.assessments}}</h5>
           <h5 class="pull-left">Completion Rate: {{project.counts.assessments ? ((project.counts.completed / project.counts.assessments) * 100 |number:1) + '%'  : 'No Assessments'}}</h5>
       </div>
      <div class="collapsable clearfix" uib-collapse="project.collapsed">

        <teds-dropdown title="Artifacts" header-stats="{count: project.artifacts.length}" class="artifacts container col-xs-12">

          <div class="menu col-xs-12 clearfix">
              <span class="btn btn-primary" ng-click="modals.open('artifact', project, $index)"><i class="fa fa-plus"></i> Add a Artifact</span>
          </div>

          <teds-filter-list list="project.artifactsList" passback="project.selected.artifact">
            <!-- {{project.selected.artifact}} -->
            <h2><a ng-href="{{project.selected.artifact.artifactURL}}">{{project.selected.artifact.artifactName}}</a></h2>
            <h5>Artifact Type: {{project.selected.artifact.artifactTypeName}}</h5>
            <p>{{project.selected.artifact.artifactDescription}}</p>
            <teds-pivot-table class="clearfix" teds-data="project.selected.artifact.stats" teds-options="pivotOptions" teds-passback="project.selected.artifact.passback">
              <div class="clearfix" ng-show="project.selected.artifact.passback.cell">
                <div class="clearfix">
                  <h3>{{project.selected.artifact.passback.column.name}}</h3>
                  <h5>{{project.selected.artifact.passback.column.desc}}</h5>
                  <h4>Questions</h4>
                  <div class="col-sm-4" ng-repeat="question in project.selected.artifact.passback.column.questions">
                    <p>{{question.name}}</p>
                    <h5>{{question.desc}}</h5>
                    <nvd3 options="sampleChartOptions" data="question.chartData"></nvd3>
                  </div>
                </div>

                <div class="divider clearfix"></div>

                <div>
                  <h3>{{project.selected.artifact.passback.row.name}}</h3>
                  <h5>{{project.selected.artifact.passback.row.desc}}</h5>
                </div>

                <div class="divider clearfix"></div>

                <div class="clearfix">
                  <h4>Ratings</h4>
                  <ul class="list-unstyled">
                    <li class="col-sm-4" ng-repeat="rating in project.selected.artifact.passback.cell.ratings">
                      <h5>ID: {{rating.ratingID}}</h5>
                      <h5>Value: {{rating.ratingValue}}</h5>
                      <h5 ng-show="rating.comments.length > 0">Comment: <span>{{rating.comments[0].comment}}</span></h5>
                      <div class="clearfix" ng-show="rating.screenshots.length > 0">
                        <h5>Screenshots</h5>
                        <div class="col-xs-6" ng-repeat="screenshot in rating.screenshots">
                            <a class="clickable" ng-href="{{screenshot.screenshotPath}}" target="_blank">
                              <img ng-src="{{screenshot.screenshotPath}}" class="col-xs-12 img-thumbnail" alt="">
                            </a>
                        </div>
                      </div>
                    </li>
                  </ul>
                </div>
              </div>

            </teds-pivot-table>
          </teds-filter-list>

        </teds-dropdown>


        <teds-dropdown title="Scenarios" header-stats="{count: project.scenarios.length}" class="scenarios container col-xs-12 clearfix">

          <div class="menu col-xs-12 clearfix">
              <span class="btn btn-primary" ng-click="modals.open('scenario', project, $index)"><i class="fa fa-plus"></i> Add a Scenario</span>
          </div>
          <teds-filter-list list="project.scenariosList" passback="project.selected.scenario">
            <h4>{{project.selected.scenario.scenarioName}}</h4>
            <h5>{{project.selected.scenario.scenarioDescription}}</h5>
            <teds-pivot-table class="clearfix" teds-data="project.selected.scenario.stats" teds-options="pivotOptions" teds-passback="project.selected.scenario.passback">
              <div ng-show="project.selected.scenario.passback.row">
                <h3>{{project.selected.scenario.passback.row.name}}</h3>
                <h5>{{project.selected.scenario.passback.row.desc}}</h5>
                <h4>Comments</h4>
                <ul class="list-unstyled">
                  <li ng-repeat="comment in project.selected.scenario.passback.row.comments">
                    {{comment.comment}}
                  </li>
                </ul>

                <h4>Screenshots</h4>
                <div class="col-xs-3" ng-repeat="screenshot in project.selected.scenario.passback.row.screenshots">
                    <a ng-click="Lightbox.openModal(project.selected.scenario.passback.row.screenshots, $index)">
                      <img ng-src="{{screenshot.screenshotPath}}" class="col-xs-12 img-thumbnail" alt="">
                    </a>
                </div>
              </div>
              <div class="divider" ng-show="project.selected.scenario.passback.column && project.selected.scenario.passback.row"></div>
              <div ng-show="project.selected.scenario.passback.column">
                <h3>{{project.selected.scenario.passback.column.name}}</h3>
                <h5>{{project.selected.scenario.passback.column.desc}}</h5>
                <h4>Questions</h4>
                <div class="col-sm-4" ng-repeat="question in project.selected.scenario.passback.column.questions">
                  <p>{{question.name}}</p>
                  <h5>{{question.desc}}</h5>
                  <nvd3 options="sampleChartOptions" data="question.chartData"></nvd3>
                </div>
              </div>
            </teds-pivot-table>
          </teds-filter-list>
        </teds-dropdown>

        <teds-dropdown title="Personas" header-stats="{count: project.personas.length}" class="personas container col-xs-12 clearfix">
          <div ng-repeat="(personaKey, persona) in project.personas" class="clearfix col-xs-6 persona project-item">
              <h5 class="name">{{persona.personaName}}</h5>
              <h6 class="desc">{{persona.personaDesc}}</h6>
          </div>
          <div class="menu col-xs-12 clearfix">
              <span class="btn btn-primary" ng-click="modals.open('persona', project, $index)"><i class="fa fa-plus"></i> Add a Persona</span>
          </div>
        </teds-dropdown>

        <teds-dropdown title="Roles" header-stats="{count: project.roles.length}" class="roles container col-xs-12 clearfix">
          <div ng-repeat="(roleKey, role) in project.roles" class="clearfix col-xs-6 role project-item">
              <h5 class="name">{{role.roleName}}</h5>
              <h6 class="desc">{{role.roleDesc}}</h6>
          </div>
          <div class="menu col-xs-12 clearfix">
              <span class="btn btn-primary" ng-click="modals.open('role', project, $index)"><i class="fa fa-plus"></i> Add a Role</span>
          </div>
        </teds-dropdown>

        <teds-dropdown title="Assessments" header-stats="project.assessmentsStats" class="assessments container col-xs-12 clearfix">
          <div class="menu col-xs-12 clearfix">
              <span class="btn btn-primary" ng-click="modals.open('assessment', project, $index)"><i class="fa fa-plus"></i> Add an Assessment</span>
          </div>
          <teds-filter-list list="project.assessmentsList" passback="project.selected.assignment"></teds-filter-list>
        </teds-dropdown>

        <teds-dropdown title="Configurations" header-stats="project.configurationsStats" class="configurations container col-xs-12 clearfix">
           <div class="menu col-xs-12 clearfix">
               <span class="btn btn-primary" ng-click="modals.open('configuration', project, $index)"><i class="fa fa-plus"></i> Add a Configuration</span>
           </div>
           <teds-filter-list list="project.configurationsList" passback="project.selected.configuration">
              <div class="clearfix">
                <h4>
                  Configuration - {{project.selected.configuration.artifactName}}, {{project.selected.configuration.scenarioName}}
                </h4>
                <div class="col-xs-6">
                  <h5>Assessment Configuration</h5>
                  <dl>
                    <dt>Artifact</dt>
                    <dd>
                      <h6>{{project.selected.configuration.artifactName}} - {{project.selected.configuration.artifactTypeName}}</h6>
                      <h6>{{project.selected.configuration.artifactDescription}}</h6>
                    </dd>
                    <dt>Scenario</dt>
                    <dd>
                      <h6>{{project.selected.configuration.scenarioName}}</h6>
                      <h6>{{project.selected.configuration.scenarioDescription}}</h6>
                    </dd>
                    <dt>Persona</dt>
                    <dd>
                      <h6>{{project.selected.configuration.personaName}}</h6>
                      <h6>{{project.selected.configuration.personaDescription}}</h6>
                    </dd>
                    <dt>Role</dt>
                    <dd>
                      <h6>{{project.selected.configuration.roleName}}</h6>
                      <h6>{{project.selected.configuration.roleDesc}}</h6>
                    </dd>
                  </dl>
                </div>
                <div class="col-xs-6">
                  <h5>Attribute Configuration</h5>
                  <h6><b>{{project.selected.configuration.attributeConfigurationName}}</b></h6>
                  <h6>{{project.selected.configuration.attributeConfigurationDesc}}</h6>
                </div>
                <div class="col-xs-6">
                  <h5>Question Configuration</h5>
                  <h6><b>{{project.selected.configuration.questionConfigurationName}}</b></h6>
                  <h6>{{project.selected.configuration.questionConfigurationDesc}}</h6>
                </div>
                <div class="col-xs-6">
                  <h5>UI Configuration</h5>
                  <h6><b>{{project.selected.configuration.uiConfigurationName}}</b></h6>
                  <h6>{{project.selected.configuration.uiConfigurationDesc}}</h6>
                </div>
              </div>

              <teds-pivot-table class="clearfix" teds-data="project.selected.configuration.stats" teds-options="pivotOptions" teds-passback="project.selected.configuration.passback">
                <div ng-show="project.selected.configuration.passback.row">
                  <h3>{{project.selected.configuration.passback.row.name}}</h3>
                  <h5>{{project.selected.configuration.passback.row.desc}}</h5>
                  <h4>Comments</h4>
                  <ul class="list-unstyled">
                    <li ng-repeat="comment in project.selected.configuration.passback.row.comments">
                      {{comment.comment}}
                    </li>
                  </ul>

                  <h4>Screenshots</h4>
                  <div class="col-xs-3" ng-repeat="screenshot in project.selected.configuration.passback.row.screenshots">
                      <a ng-click="Lightbox.openModal(project.selected.configuration.passback.row.screenshots, $index)">
                        <img ng-src="{{screenshot.screenshotPath}}" class="col-xs-12 img-thumbnail" alt="">
                      </a>
                  </div>
                </div>
                <div class="divider" ng-show="project.selected.configuration.passback.column && project.selected.configuration.passback.row"></div>
                <div ng-show="project.selected.configuration.passback.column">
                  <h3>AssessmentID: {{project.selected.configuration.passback.column.name}}</h3>
                  <h5>Owner: {{project.selected.configuration.passback.column.email}}</h5>
                  <h4>Questions</h4>
                  <div class="col-sm-6" ng-repeat="question in project.selected.configuration.passback.column.questions">
                    <p>{{question.name}}</p>
                    <h5>{{question.desc}}</h5>
                    <h6>Answer: {{question.responses[0].answer}}</h6>
                    <!-- <nvd3 options="sampleChartOptions" data="question.chartData"></nvd3> -->
                  </div>
                </div>
              </teds-pivot-table>

           </teds-filter-list>
        </teds-dropdown>
      </div>


   </div>
</div>